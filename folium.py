import folium
import csv
from folium import plugins
import datetime
import random
import sormasapi
import os
import json

def load_json(filename):
    jsondict = {}
    with open(filename) as jsonfile:
        jsondict = json.load(jsonfile)
    return jsondict
    
def parse_export_json():
    #open cases
    #Get case information (Q-dates etc.)
    #open persons
    #For every case: 
    #    get GPS
    cases = load_json(os.path.join("cache","cases.json"))
    persons = load_json(os.path.join("cache","persons.json"))
    d={}
    for case in cases.values():
        if case.get("caseClassification","").startswith("CON") and case["responsibleDistrict"]["uuid"] == "XOPA44-6XGVPV-MSHDXP-RJ4BCBNE" and case.get("deleted","NO")=="NO":
            if persons.get(case["person"]["uuid"],{}).get("address",{}).get("latitude","") and persons.get(case["person"]["uuid"],{}).get("birthdateYYYY",0)<2004:
                fullyVaccinated = "NA"
                if sormasapi.is_fully_vaccinated(case):
                    fullyVaccinated = "COMPLETE"
                elif case.get("vaccination","")=="VACCINATED":
                    fullyVaccinated = "INCOMPLETE"
                elif case.get("vaccination","")=="UNVACCINATED":
                    fullyVaccinated = "UNVACCINATED" 
                
                deceasedDate = 0
                if case.get("outcome") == "DECEASED":
                    deceasedDate = case.get("outcomeDate",0)
                #TODO: hospitalizations, epiData, first Test
                d[case["uuid"]]={
                    "longitude": persons.get(case["person"]["uuid"],{}).get("address",{}).get("longitude",""),
                    "latitude": persons.get(case["person"]["uuid"],{}).get("address",{}).get("latitude",""),
                    "postalCode": persons.get(case["person"]["uuid"],{}).get("address",{}).get("postalCode",""), 
                    "quarantineFrom": case.get("quarantineFrom",case.get("reportDate",0)),
                    "quarantineTo": case.get("quarantineTo",case.get("quarantineFrom",case.get("reportDate",0))+1209600000),
                    "reportDate": case.get("reportDate",0),
                    "onsetDate": case.get("symptoms",{}).get("onsetDate",0),
                    "quarantineOrderedVerballyDate": case.get("quarantineOrderedVerballyDate",0),
                    "diseaseVariant":case.get("diseaseVariant",{"caption":""}),
                    "fullyVaccinated": fullyVaccinated,
                    "deceasedDate": deceasedDate,
                    "externalToken": case.get("uuid","-")}
    return d        
    
def generate_time_range(startdate, enddate, lshift=0, rshift=1):
    #start = datetime.datetime.strptime(startdate,"%d.%m.%Y")
    #end = datetime.datetime.strptime(enddate,"%d.%m.%Y")
    start = datetime.datetime.fromtimestamp(startdate/1000)
    end = datetime.datetime.fromtimestamp(enddate/1000)
    l = []
    for x in range(lshift,(end-start).days+rshift, 2):
        l.append(datetime.datetime.strftime(start+datetime.timedelta(days=x),"%Y-%m-%d"))
    if len(l)>20:
        l=l[:20]
    return l
    
def generate_timestamped_geojson(d):
    random.seed("Jockstrap")
    featurelist = []
    gpsfuzz = 0.0005 #0.0005 default
    for key in d:
        lat = d[key]["latitude"] + random.uniform(-1*gpsfuzz,gpsfuzz)
        long = d[key]["longitude"] + random.uniform(-1*gpsfuzz,gpsfuzz)
        rad = 20
        color = "grey"
        """
        if d[key]["diseaseVariant"]["caption"].startswith("B.1.1.7"):
            color="orange"
        elif d[key]["diseaseVariant"]["caption"] in ["B.1.1.28.1 - P.1","B.1.351 - 501Y.V2","B.1.525", "andere/sonstige"]:
            color="purple"
        elif d[key]["diseaseVariant"]["caption"].startswith("B.1.6"):
            color="red"
        """
        if d[key]["fullyVaccinated"]=="COMPLETE":
            color="red"
        elif d[key]["fullyVaccinated"]=="INCOMPLETE":
            color="orange"
        elif d[key]["fullyVaccinated"]=="UNVACCINATED":
            color="green"
        starttime = min([x for x in [d[key]["onsetDate"],d[key]["quarantineFrom"]] if x!=0])
        if starttime < 1580511600000 or starttime>sormasapi.now() :
            print("Starttime falsch (Symptombeginn/quarantänefrom)")
            print(d[key]["externalToken"])
        elif d[key]["reportDate"] < 1580511600000 or d[key]["reportDate"]>sormasapi.now():
            print("MeLdedatum falsch")
            print(d[key]["externalToken"])
        elif d[key]["quarantineTo"] < 1580511600000 or d[key]["quarantineTo"]>sormasapi.now()+1209600000:
            print("Quarantänedatum")
            print(d[key]["externalToken"])
        else:
            for day in generate_time_range(starttime, d[key]["quarantineTo"], lshift=-2): #d[key]["reportDate"], lshift=-2, rshift=0):
                feature = {
                    "type" : "Feature",
                    "properties" : {
                        "time" : day,
                        "name" : d[key]["externalToken"],
                        "style": { "color" : color },
                        "icon" : "circle",
                        "iconstyle" : {
                            "fillColor" : color,
                            "fillOpacity" : 0.4,
                            "radius" : rad }
                    },
                    "geometry" : {
                        "type": "Point",  
                        "coordinates" : [long, lat] }
                }
                featurelist.append(feature)
                rad-=1
            """
            for day in generate_time_range(d[key]["reportDate"],d[key]["quarantineTo"]):
                color = "grey"
                feature = {
                    "type" : "Feature",
                    "properties" : {
                        "time" : day,
                        "name" : d[key]["externalToken"],
                        "style": { "color" : color },
                        "icon" : "circle",
                        "iconstyle" : {
                            "fillColor" : color,
                            "fillOpacity" : 0.2,
                            "radius" : rad }
                    },
                    "geometry" : {
                        "type": "Point",  
                        "coordinates" : [long, lat] }
                }
                featurelist.append(feature)
                rad-=1
            """
            if d[key]["deceasedDate"]:
                rad = 10
                color = "black"
                op = 1
                for day in generate_time_range(d[key]["deceasedDate"],d[key]["deceasedDate"], lshift=0, rshift=8):
                    feature = {
                        "type" : "Feature",
                        "properties" : {
                            "time" : day,
                            "name" : d[key]["externalToken"],
                            "style": { "color" : color },
                            "icon" : "circle",
                            "iconstyle" : {
                                "fillColor" : color,
                                "fillOpacity" : op,
                                "radius" : rad }
                            },
                            "geometry" : {
                                "type": "Point",  
                                "coordinates" : [long, lat] }
                    }
                    op-=0.15
                    featurelist.append(feature)
    return featurelist

if __name__ == "__main__":
    d = parse_export_json()
    print(len(d))
    #LOR_planungsregionen = "https://github.com/rbb-data/berlin-lor/blob/master/berlin-lor.bezirksregionen.geojson"
    style1 = {'color': '#000000',"weight":5, "fillColor":"000000", "fillOpacity":0.05}
    FK = {"type":"FeatureCollection", "features":[{"type":"Feature","properties":{"name":"Friedrichshain-Kreuzberg","description":"","cartodb_id":2,"created_at":"2013-09-03T12:32:04+0200","updated_at":"2013-09-03T12:32:04+0200"},"geometry":{"type":"MultiPolygon","coordinates":[[[[13.429402,52.508572],[13.42924,52.508671],[13.429206,52.508725],[13.429187,52.508819],[13.429176,52.508836],[13.429153,52.508854],[13.429123,52.508866],[13.429137,52.508885],[13.429135,52.508895],[13.429121,52.508904],[13.428921,52.508966],[13.428905,52.50897],[13.428887,52.508967],[13.428856,52.508978],[13.428666,52.508991],[13.428373,52.509071],[13.428163,52.509227],[13.428082,52.509287],[13.426707,52.510094],[13.426021,52.510497],[13.426015,52.510492],[13.425771,52.510635],[13.42511,52.511019],[13.42487,52.511162],[13.424503,52.511381],[13.423655,52.511809],[13.423417,52.511946],[13.423248,52.512044],[13.423184,52.512088],[13.423078,52.51213],[13.423051,52.512128],[13.423032,52.512117],[13.423012,52.512127],[13.422781,52.512234],[13.422794,52.512249],[13.423021,52.512487],[13.42322,52.512701],[13.423246,52.512729],[13.42324,52.512731],[13.423298,52.512794],[13.423349,52.512848],[13.423419,52.512924],[13.423677,52.513194],[13.423844,52.513369],[13.423948,52.513564],[13.424011,52.513681],[13.424068,52.51374],[13.424103,52.513786],[13.424239,52.513945],[13.424299,52.514021],[13.42439,52.514137],[13.424859,52.514752],[13.425004,52.514944],[13.425103,52.515081],[13.42514,52.515142],[13.425599,52.515939],[13.425672,52.51607],[13.42582,52.516339],[13.425963,52.516571],[13.426393,52.517327],[13.426388,52.517342],[13.42641,52.517376],[13.426476,52.517476],[13.426754,52.517959],[13.426506,52.51801],[13.426339,52.518045],[13.426332,52.518032],[13.426149,52.518071],[13.426187,52.518125],[13.42624,52.518197],[13.426303,52.51829],[13.425927,52.518392],[13.426191,52.518752],[13.426569,52.519269],[13.426881,52.519696],[13.426917,52.519744],[13.427355,52.519627],[13.427411,52.519615],[13.427464,52.519608],[13.427498,52.519606],[13.428401,52.519586],[13.428457,52.5197],[13.428907,52.520622],[13.428941,52.520693],[13.42919,52.521204],[13.429182,52.521224],[13.428566,52.521487],[13.427788,52.521819],[13.427623,52.521895],[13.42672,52.52228],[13.425931,52.522624],[13.425548,52.522791],[13.425908,52.522831],[13.426004,52.522925],[13.426154,52.52293],[13.426521,52.522939],[13.426512,52.523064],[13.426509,52.523168],[13.426502,52.523291],[13.426336,52.523299],[13.426255,52.523306],[13.426174,52.523314],[13.426093,52.523323],[13.426013,52.523333],[13.425882,52.523353],[13.425754,52.523381],[13.425485,52.523447],[13.425434,52.523441],[13.424779,52.523631],[13.424246,52.523796],[13.424113,52.523841],[13.423956,52.523897],[13.423703,52.523991],[13.423376,52.524119],[13.42163,52.524806],[13.421477,52.524866],[13.421186,52.524978],[13.420501,52.52525],[13.419753,52.525545],[13.421517,52.52662],[13.421989,52.526908],[13.422558,52.527254],[13.423642,52.527915],[13.423809,52.527901],[13.424005,52.527882],[13.424455,52.527899],[13.424469,52.527913],[13.424515,52.527901],[13.424664,52.527908],[13.424855,52.527878],[13.424951,52.527995],[13.425027,52.528095],[13.425323,52.52813],[13.427641,52.5284],[13.429019,52.528561],[13.430375,52.528717],[13.431186,52.528814],[13.436315,52.529412],[13.437482,52.529548],[13.437918,52.529155],[13.438311,52.5288],[13.438746,52.528778],[13.442278,52.531025],[13.444552,52.528922],[13.445849,52.527714],[13.446057,52.52753],[13.44648,52.527139],[13.446541,52.527007],[13.446555,52.526975],[13.446933,52.526628],[13.447169,52.526408],[13.447923,52.526633],[13.448611,52.526839],[13.449338,52.527056],[13.450487,52.527399],[13.450783,52.527487],[13.451419,52.527627],[13.451914,52.527736],[13.452183,52.527796],[13.452276,52.527689],[13.452329,52.527633],[13.452417,52.527526],[13.453201,52.526373],[13.453325,52.526191],[13.454157,52.524968],[13.455086,52.523602],[13.455758,52.522612],[13.4558,52.522552],[13.456157,52.522457],[13.45529,52.521272],[13.458244,52.520735],[13.45872,52.520649],[13.458951,52.520607],[13.462695,52.519927],[13.465419,52.520149],[13.465575,52.520163],[13.466898,52.520268],[13.467001,52.520277],[13.467194,52.520292],[13.469328,52.520465],[13.469791,52.520503],[13.470657,52.520573],[13.47127,52.520624],[13.472107,52.520694],[13.472137,52.520667],[13.472272,52.520678],[13.472354,52.520511],[13.472434,52.520517],[13.472555,52.520527],[13.473213,52.519877],[13.473082,52.51988],[13.473422,52.519475],[13.47376,52.519088],[13.474197,52.519116],[13.474231,52.519057],[13.474746,52.518215],[13.475009,52.517788],[13.475395,52.517162],[13.475598,52.516851],[13.476008,52.516195],[13.476048,52.516126],[13.476262,52.515719],[13.476456,52.5153],[13.476479,52.515268],[13.476547,52.515173],[13.476572,52.515154],[13.476714,52.515045],[13.476804,52.515015],[13.477303,52.514859],[13.477588,52.514776],[13.477748,52.514729],[13.477597,52.514533],[13.477485,52.514389],[13.475887,52.514863],[13.4755,52.513821],[13.475438,52.513433],[13.475533,52.513069],[13.475633,52.513057],[13.475768,52.512474],[13.475839,52.512122],[13.475928,52.512114],[13.475941,52.51206],[13.475891,52.512054],[13.476267,52.510441],[13.476161,52.510348],[13.476043,52.5103],[13.475828,52.510257],[13.475767,52.510161],[13.475566,52.509857],[13.475419,52.509634],[13.474442,52.508616],[13.473961,52.508109],[13.4739,52.508102],[13.474028,52.508068],[13.473937,52.50797],[13.473806,52.508007],[13.473822,52.507931],[13.473067,52.507126],[13.473409,52.506924],[13.472827,52.506707],[13.472788,52.506646],[13.472769,52.506575],[13.472804,52.506491],[13.472729,52.506455],[13.472712,52.506359],[13.47226,52.506109],[13.471749,52.505735],[13.471688,52.505677],[13.471518,52.505515],[13.471481,52.505468],[13.471359,52.505342],[13.471164,52.505136],[13.471299,52.505005],[13.471262,52.504963],[13.470764,52.504437],[13.470424,52.50406],[13.470208,52.503743],[13.46983,52.502662],[13.469797,52.502568],[13.469787,52.50254],[13.469755,52.50245],[13.469756,52.502403],[13.469755,52.502324],[13.469679,52.502291],[13.469539,52.501941],[13.469526,52.501944],[13.469202,52.501116],[13.469195,52.501073],[13.469029,52.500595],[13.468877,52.500158],[13.468772,52.500158],[13.468573,52.499652],[13.469414,52.499528],[13.473081,52.498991],[13.474521,52.498036],[13.482642,52.492655],[13.48373,52.491933],[13.484089,52.491696],[13.484145,52.491658],[13.484936,52.491604],[13.485773,52.491199],[13.486088,52.490799],[13.488462,52.489888],[13.488813,52.489248],[13.490164,52.488759],[13.491454,52.488265],[13.490709,52.487443],[13.490441,52.487505],[13.489871,52.487636],[13.489153,52.487761],[13.488504,52.487836],[13.487554,52.487789],[13.486739,52.487649],[13.486702,52.48764],[13.485946,52.487402],[13.484662,52.486824],[13.484105,52.486573],[13.482956,52.486046],[13.482178,52.487262],[13.482137,52.487327],[13.482056,52.487443],[13.481684,52.487635],[13.481264,52.487726],[13.48094,52.487795],[13.480551,52.487873],[13.480469,52.487887],[13.480057,52.487937],[13.479859,52.487944],[13.479638,52.487935],[13.479423,52.487923],[13.47924,52.487871],[13.479096,52.487685],[13.478631,52.487033],[13.478585,52.487081],[13.478142,52.487637],[13.478074,52.487724],[13.47802,52.48781],[13.477986,52.487865],[13.477941,52.487952],[13.477905,52.48804],[13.477854,52.488195],[13.477716,52.488731],[13.477686,52.488783],[13.477052,52.489306],[13.47613,52.489956],[13.475441,52.490326],[13.473787,52.491033],[13.471019,52.491487],[13.468496,52.492341],[13.467471,52.492588],[13.467059,52.492686],[13.465583,52.493237],[13.464216,52.493742],[13.463384,52.494132],[13.4632,52.494215],[13.463139,52.494533],[13.463423,52.494822],[13.46362,52.495],[13.463698,52.495061],[13.463725,52.495107],[13.463721,52.495206],[13.463737,52.495217],[13.463634,52.495264],[13.463384,52.495379],[13.463288,52.495412],[13.463236,52.495429],[13.463186,52.495447],[13.463113,52.495394],[13.463057,52.495352],[13.462796,52.495407],[13.462295,52.495514],[13.461938,52.495586],[13.461834,52.495607],[13.461826,52.4956],[13.459761,52.496408],[13.459463,52.496493],[13.455388,52.4973],[13.455039,52.497367],[13.454068,52.497559],[13.453352,52.497525],[13.452727,52.497573],[13.452682,52.497573],[13.452095,52.497481],[13.451758,52.497413],[13.451445,52.497333],[13.4512,52.497243],[13.450909,52.497108],[13.450648,52.496943],[13.4507,52.496928],[13.450617,52.496867],[13.450294,52.496625],[13.450282,52.496616],[13.450054,52.496474],[13.449984,52.496417],[13.44996,52.4964],[13.449752,52.496247],[13.447883,52.494846],[13.447792,52.494783],[13.447659,52.494721],[13.447582,52.494698],[13.447424,52.494664],[13.447262,52.494643],[13.447179,52.494636],[13.446988,52.494636],[13.446905,52.494646],[13.446542,52.494689],[13.446409,52.494716],[13.446332,52.494728],[13.446253,52.494733],[13.446122,52.494736],[13.445819,52.494717],[13.445768,52.494709],[13.445481,52.494643],[13.445351,52.494596],[13.445224,52.494547],[13.4451,52.49449],[13.444976,52.494423],[13.444714,52.494221],[13.444556,52.494101],[13.44356,52.493333],[13.442611,52.492599],[13.441288,52.491571],[13.440816,52.491202],[13.440682,52.491107],[13.440577,52.49104],[13.440458,52.490973],[13.440336,52.49091],[13.440228,52.490861],[13.440037,52.490733],[13.439893,52.490602],[13.439824,52.490487],[13.439761,52.490353],[13.439697,52.490118],[13.439656,52.489908],[13.439643,52.489834],[13.439634,52.489695],[13.439616,52.489692],[13.439628,52.489659],[13.439264,52.48961],[13.439253,52.489644],[13.439234,52.489641],[13.439228,52.48966],[13.438271,52.490376],[13.43544,52.491277],[13.435176,52.491359],[13.430943,52.492703],[13.430135,52.492964],[13.429515,52.493167],[13.428458,52.493511],[13.428177,52.493603],[13.426295,52.494215],[13.422835,52.49534],[13.422487,52.495447],[13.422219,52.495522],[13.421947,52.495592],[13.421673,52.495656],[13.421394,52.495714],[13.42097,52.495789],[13.420697,52.49583],[13.420486,52.495858],[13.420401,52.495864],[13.420462,52.49579],[13.420792,52.495475],[13.421226,52.494775],[13.421593,52.494198],[13.421707,52.494022],[13.421887,52.493732],[13.422162,52.493301],[13.422298,52.493083],[13.4224,52.49292],[13.422778,52.492314],[13.422804,52.492272],[13.422922,52.492084],[13.422948,52.492042],[13.423484,52.491181],[13.423586,52.491017],[13.42398,52.490387],[13.424198,52.49004],[13.424298,52.489878],[13.424559,52.489456],[13.424876,52.48894],[13.424876,52.488938],[13.424869,52.488937],[13.424862,52.488932],[13.424867,52.488907],[13.424875,52.488903],[13.424882,52.488901],[13.424886,52.488899],[13.424901,52.488901],[13.424959,52.488808],[13.424963,52.488784],[13.424971,52.488779],[13.424977,52.48878],[13.425287,52.488285],[13.425411,52.488085],[13.424938,52.487784],[13.424024,52.486681],[13.423682,52.486358],[13.423366,52.486449],[13.423049,52.486544],[13.421297,52.487054],[13.421082,52.487108],[13.420843,52.487168],[13.418442,52.487482],[13.415497,52.487867],[13.414253,52.48803],[13.414123,52.488047],[13.413592,52.488116],[13.413443,52.488134],[13.411925,52.488333],[13.410623,52.488503],[13.409175,52.488692],[13.407886,52.488861],[13.40772,52.488751],[13.407843,52.488487],[13.407906,52.488478],[13.407983,52.488312],[13.408528,52.487144],[13.408414,52.487035],[13.407459,52.486149],[13.40702,52.485985],[13.406297,52.485713],[13.404392,52.484997],[13.401547,52.485001],[13.400491,52.483847],[13.40046,52.483813],[13.400386,52.483732],[13.400218,52.483735],[13.398111,52.483782],[13.396024,52.483828],[13.394238,52.483866],[13.394242,52.484343],[13.394253,52.485771],[13.392589,52.485784],[13.386291,52.485826],[13.386275,52.485159],[13.386268,52.484863],[13.385761,52.484867],[13.384599,52.484874],[13.384479,52.484875],[13.383846,52.484878],[13.383457,52.48488],[13.382405,52.484886],[13.381999,52.484889],[13.37704,52.484917],[13.37635,52.484922],[13.37431,52.484934],[13.374037,52.484936],[13.372793,52.484944],[13.372383,52.484946],[13.371935,52.484948],[13.371569,52.48495],[13.371661,52.485121],[13.371605,52.485121],[13.371643,52.485183],[13.374021,52.48517],[13.374051,52.48561],[13.374099,52.486294],[13.374159,52.487158],[13.374164,52.487711],[13.373503,52.487746],[13.373536,52.487982],[13.374731,52.48938],[13.3754,52.489432],[13.375475,52.490456],[13.376405,52.491433],[13.376434,52.491676],[13.37632,52.491699],[13.376211,52.491721],[13.376104,52.491742],[13.37596,52.491771],[13.375781,52.491807],[13.375519,52.49186],[13.374995,52.491966],[13.374679,52.49203],[13.374412,52.492083],[13.373858,52.492195],[13.373077,52.492352],[13.372796,52.492409],[13.37273,52.492422],[13.372526,52.492463],[13.372289,52.492511],[13.372018,52.492566],[13.371456,52.492679],[13.371394,52.492691],[13.371314,52.492707],[13.371069,52.492757],[13.371077,52.492913],[13.369238,52.493281],[13.369164,52.49314],[13.368872,52.493199],[13.368714,52.493231],[13.36827,52.493319],[13.368215,52.493331],[13.36831,52.493472],[13.36839,52.493605],[13.368581,52.493955],[13.368415,52.494475],[13.368423,52.494595],[13.368596,52.496511],[13.368636,52.496929],[13.368678,52.497385],[13.369601,52.498109],[13.369728,52.498775],[13.369528,52.49887],[13.370362,52.499511],[13.370357,52.499517],[13.37036,52.499532],[13.370555,52.499683],[13.370587,52.499685],[13.37078,52.499834],[13.370846,52.499899],[13.370867,52.499929],[13.370878,52.49995],[13.370895,52.499998],[13.370989,52.500309],[13.371317,52.501393],[13.371349,52.501497],[13.371382,52.501573],[13.371436,52.501645],[13.371549,52.501766],[13.372914,52.503243],[13.373029,52.503365],[13.373313,52.503756],[13.373443,52.503936],[13.373606,52.504163],[13.373718,52.504054],[13.373792,52.503973],[13.37379,52.503966],[13.373873,52.503874],[13.373879,52.503875],[13.373978,52.503768],[13.374152,52.503586],[13.374251,52.503494],[13.374419,52.503378],[13.374681,52.503235],[13.374746,52.503236],[13.374787,52.503264],[13.374977,52.503378],[13.375159,52.503689],[13.376226,52.505523],[13.376378,52.505783],[13.377619,52.507916],[13.377649,52.507967],[13.377849,52.507807],[13.378941,52.506931],[13.379446,52.506949],[13.382385,52.507119],[13.38542,52.50731],[13.385762,52.507329],[13.390207,52.507587],[13.390495,52.507603],[13.392125,52.507698],[13.392451,52.50772],[13.394058,52.507818],[13.394383,52.507838],[13.396058,52.50794],[13.397053,52.508002],[13.398772,52.508113],[13.398795,52.508093],[13.399232,52.508077],[13.399602,52.508575],[13.399996,52.509111],[13.40019,52.509376],[13.400229,52.509381],[13.400909,52.50914],[13.401258,52.509041],[13.40141,52.508984],[13.402097,52.50873],[13.402753,52.508536],[13.403262,52.508328],[13.403633,52.508177],[13.403821,52.508093],[13.404037,52.507995],[13.404302,52.507862],[13.40444,52.507771],[13.40458,52.507886],[13.404632,52.507922],[13.405285,52.508211],[13.406124,52.507593],[13.40641,52.507382],[13.406601,52.507233],[13.407361,52.506648],[13.407395,52.506664],[13.407844,52.506323],[13.40784,52.506305],[13.40803,52.50618],[13.408162,52.506231],[13.408759,52.50646],[13.409455,52.506727],[13.409971,52.506926],[13.4114,52.505056],[13.411521,52.504891],[13.41181,52.504792],[13.41336,52.504276],[13.414073,52.504038],[13.414199,52.504187],[13.414327,52.504341],[13.41461,52.50468],[13.414594,52.504793],[13.414908,52.504918],[13.416796,52.504394],[13.417079,52.504316],[13.417309,52.504251],[13.417601,52.50417],[13.418213,52.505018],[13.418402,52.504993],[13.418519,52.504987],[13.418532,52.50497],[13.418808,52.50503],[13.418943,52.50506],[13.418925,52.50508],[13.41899,52.505116],[13.419048,52.505156],[13.419102,52.505199],[13.419135,52.50524],[13.419431,52.505649],[13.419535,52.505623],[13.41967,52.505585],[13.419851,52.505535],[13.42033,52.5054],[13.420903,52.505243],[13.421132,52.505175],[13.42139,52.505115],[13.421544,52.505078],[13.421811,52.505042],[13.422091,52.505027],[13.4223,52.505008],[13.422668,52.504987],[13.422915,52.504981],[13.423041,52.504981],[13.42323,52.504983],[13.423359,52.504988],[13.423609,52.505001],[13.423734,52.505009],[13.423981,52.50503],[13.424349,52.505075],[13.424471,52.505093],[13.424713,52.505133],[13.424951,52.50518],[13.425137,52.505228],[13.425317,52.505273],[13.425498,52.505322],[13.425822,52.505425],[13.426438,52.505685],[13.42671,52.505799],[13.42698,52.505729],[13.4272,52.505666],[13.42744,52.506009],[13.428267,52.507192],[13.42843,52.507424],[13.428816,52.50798],[13.429028,52.508036],[13.429402,52.508572]]]]}}]}
    #NK = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"name":"Neukölln","description":"","cartodb_id":8,"created_at":"2013-09-03T12:32:04+0200","updated_at":"2013-09-03T12:32:04+0200"},"geometry":{"type":"MultiPolygon","coordinates":[[[[13.411258,52.439124],[13.41217,52.441494],[13.412488,52.442304],[13.412844,52.443174],[13.413397,52.44453],[13.413402,52.444543],[13.413416,52.444577],[13.41343,52.444612],[13.413456,52.444672],[13.413926,52.445801],[13.413985,52.445945],[13.414033,52.446009],[13.414579,52.446736],[13.414767,52.447011],[13.414998,52.44807],[13.415105,52.448475],[13.415731,52.449266],[13.415946,52.450168],[13.416078,52.450825],[13.416392,52.45141],[13.416524,52.45166],[13.416545,52.451698],[13.416837,52.452239],[13.417682,52.452201],[13.418282,52.45297],[13.418362,52.453075],[13.418782,52.453617],[13.418853,52.453702],[13.419319,52.454243],[13.419574,52.454573],[13.419658,52.454681],[13.419874,52.454995],[13.420731,52.456242],[13.420764,52.456289],[13.42085,52.456384],[13.42088,52.456417],[13.421085,52.456638],[13.421196,52.456752],[13.421392,52.456711],[13.422115,52.456664],[13.422826,52.456647],[13.423529,52.456614],[13.424262,52.456605],[13.424946,52.456597],[13.425658,52.456625],[13.42657,52.456699],[13.424875,52.457766],[13.424615,52.457898],[13.424371,52.457997],[13.422877,52.458541],[13.420608,52.459368],[13.420758,52.459605],[13.421425,52.460655],[13.423233,52.460404],[13.423009,52.461318],[13.421972,52.461516],[13.422031,52.461607],[13.422049,52.461858],[13.422084,52.46212],[13.422133,52.46246],[13.42214,52.462511],[13.422097,52.462722],[13.4219,52.462867],[13.42171,52.463497],[13.421686,52.463952],[13.421648,52.464668],[13.421624,52.465136],[13.42162,52.4653],[13.421553,52.465762],[13.421542,52.465838],[13.421507,52.465835],[13.421266,52.465812],[13.419,52.465592],[13.417326,52.465437],[13.416879,52.465396],[13.41686,52.465475],[13.416768,52.465893],[13.416705,52.466172],[13.416561,52.466835],[13.416039,52.469151],[13.41578,52.47031],[13.415596,52.470986],[13.415017,52.473107],[13.415008,52.47314],[13.414672,52.474371],[13.414125,52.476376],[13.413698,52.477939],[13.413687,52.47798],[13.413588,52.478343],[13.413541,52.478515],[13.413488,52.478708],[13.410939,52.477902],[13.410885,52.477723],[13.407441,52.478112],[13.40689,52.478174],[13.406815,52.478185],[13.406706,52.478208],[13.406672,52.478218],[13.406623,52.478233],[13.406657,52.478353],[13.406802,52.478862],[13.40624,52.480157],[13.406063,52.480986],[13.406152,52.481228],[13.406251,52.481978],[13.406277,52.481976],[13.40635,52.482474],[13.406395,52.48277],[13.40642,52.482934],[13.406699,52.484795],[13.406716,52.484912],[13.406765,52.485215],[13.406823,52.485392],[13.406865,52.48548],[13.40692,52.485578],[13.406978,52.485663],[13.407043,52.485745],[13.407114,52.485824],[13.407191,52.4859],[13.407459,52.486149],[13.408414,52.487035],[13.408528,52.487144],[13.407983,52.488312],[13.407906,52.488478],[13.407843,52.488487],[13.40772,52.488751],[13.407886,52.488861],[13.409175,52.488692],[13.410623,52.488503],[13.411925,52.488333],[13.413443,52.488134],[13.413592,52.488116],[13.414123,52.488047],[13.414253,52.48803],[13.415497,52.487867],[13.418442,52.487482],[13.420843,52.487168],[13.421082,52.487108],[13.421297,52.487054],[13.423049,52.486544],[13.423366,52.486449],[13.423682,52.486358],[13.424024,52.486681],[13.424938,52.487784],[13.425411,52.488085],[13.425287,52.488285],[13.424977,52.48878],[13.424971,52.488779],[13.424963,52.488784],[13.424959,52.488808],[13.424901,52.488901],[13.424886,52.488899],[13.424882,52.488901],[13.424875,52.488903],[13.424867,52.488907],[13.424862,52.488932],[13.424869,52.488937],[13.424876,52.488938],[13.424876,52.48894],[13.424559,52.489456],[13.424298,52.489878],[13.424198,52.49004],[13.42398,52.490387],[13.423586,52.491017],[13.423484,52.491181],[13.422948,52.492042],[13.422922,52.492084],[13.422804,52.492272],[13.422778,52.492314],[13.4224,52.49292],[13.422298,52.493083],[13.422162,52.493301],[13.421887,52.493732],[13.421707,52.494022],[13.421593,52.494198],[13.421226,52.494775],[13.420792,52.495475],[13.420462,52.49579],[13.420401,52.495864],[13.420486,52.495858],[13.420697,52.49583],[13.42097,52.495789],[13.421394,52.495714],[13.421673,52.495656],[13.421947,52.495592],[13.422219,52.495522],[13.422487,52.495447],[13.422835,52.49534],[13.426295,52.494215],[13.428177,52.493603],[13.428458,52.493511],[13.429515,52.493167],[13.430135,52.492964],[13.430943,52.492703],[13.435176,52.491359],[13.43544,52.491277],[13.438271,52.490376],[13.439228,52.48966],[13.439234,52.489641],[13.439253,52.489644],[13.439264,52.48961],[13.439628,52.489659],[13.439616,52.489692],[13.439634,52.489695],[13.439643,52.489834],[13.439656,52.489908],[13.439981,52.489743],[13.44023,52.489613],[13.440614,52.489418],[13.44212,52.488647],[13.442334,52.488537],[13.442888,52.488254],[13.443113,52.488139],[13.444232,52.487566],[13.444444,52.487457],[13.446764,52.488955],[13.447424,52.488616],[13.447593,52.48853],[13.448536,52.488046],[13.44866,52.487982],[13.448727,52.488027],[13.448844,52.487959],[13.450327,52.487086],[13.450445,52.487149],[13.450635,52.48705],[13.451033,52.486844],[13.451249,52.486735],[13.451518,52.486596],[13.452134,52.486277],[13.453475,52.485584],[13.453713,52.485462],[13.453939,52.485346],[13.456067,52.484254],[13.456242,52.484387],[13.456799,52.484808],[13.457841,52.485597],[13.458135,52.48582],[13.45832,52.485688],[13.458566,52.485521],[13.45859,52.485503],[13.459117,52.485132],[13.459548,52.484833],[13.459561,52.48484],[13.461181,52.483701],[13.461159,52.483536],[13.461218,52.483498],[13.462369,52.482683],[13.463558,52.481846],[13.465158,52.480721],[13.46598,52.480143],[13.466956,52.479455],[13.468039,52.478693],[13.469022,52.478],[13.470047,52.477277],[13.470573,52.476906],[13.470553,52.476814],[13.470383,52.476021],[13.470291,52.475726],[13.469978,52.474837],[13.469607,52.473994],[13.469587,52.473802],[13.469601,52.473726],[13.469644,52.473614],[13.469696,52.473509],[13.469796,52.473333],[13.469946,52.473144],[13.470021,52.473055],[13.47009,52.472971],[13.47012,52.472939],[13.470129,52.472927],[13.470588,52.472444],[13.470978,52.472033],[13.471974,52.471073],[13.472414,52.470654],[13.472654,52.470424],[13.472888,52.470202],[13.472917,52.470175],[13.47295,52.470144],[13.473677,52.469443],[13.474973,52.46819],[13.475165,52.468019],[13.475324,52.467885],[13.475599,52.467652],[13.476181,52.467266],[13.476351,52.46713],[13.4781,52.465458],[13.478339,52.465231],[13.478414,52.465133],[13.478479,52.464986],[13.478488,52.464868],[13.478518,52.464431],[13.478549,52.463981],[13.477358,52.462226],[13.477197,52.461993],[13.477151,52.461956],[13.475798,52.460913],[13.475393,52.460249],[13.475331,52.460149],[13.475282,52.460068],[13.475221,52.45997],[13.475173,52.459905],[13.47498,52.459472],[13.474951,52.459193],[13.474953,52.459127],[13.474967,52.458826],[13.474968,52.458807],[13.47497,52.458764],[13.473379,52.458809],[13.472615,52.458835],[13.472215,52.458849],[13.47211,52.458844],[13.471896,52.458849],[13.471791,52.458857],[13.464764,52.459043],[13.463998,52.459063],[13.462849,52.459093],[13.461514,52.459128],[13.458238,52.45921],[13.457339,52.459237],[13.45727,52.459207],[13.45723,52.459259],[13.457123,52.459256],[13.45704,52.459231],[13.456994,52.459196],[13.456975,52.459153],[13.45698,52.459108],[13.457018,52.459056],[13.457189,52.458853],[13.457232,52.458785],[13.457286,52.458671],[13.457547,52.458279],[13.458795,52.456726],[13.458905,52.456579],[13.459014,52.456472],[13.459032,52.456445],[13.460359,52.454487],[13.46044,52.454351],[13.460675,52.453987],[13.460737,52.453898],[13.461344,52.453002],[13.461406,52.452911],[13.461445,52.452861],[13.461467,52.45284],[13.461494,52.452817],[13.461707,52.452648],[13.461783,52.452555],[13.46204,52.452184],[13.462334,52.451798],[13.462564,52.451509],[13.462585,52.451448],[13.462638,52.451287],[13.462656,52.45125],[13.462657,52.451223],[13.462666,52.451202],[13.462748,52.451233],[13.462859,52.451121],[13.462938,52.451146],[13.463009,52.451124],[13.46306,52.451077],[13.463285,52.450801],[13.463497,52.45057],[13.463762,52.450311],[13.463914,52.450191],[13.46422,52.449967],[13.464729,52.449628],[13.465164,52.449357],[13.465614,52.449101],[13.466141,52.448829],[13.467557,52.448143],[13.468369,52.447751],[13.469513,52.447193],[13.472717,52.445638],[13.475862,52.444118],[13.476167,52.443974],[13.47627,52.443939],[13.476539,52.443882],[13.476676,52.443834],[13.477328,52.443517],[13.478023,52.44318],[13.478161,52.443103],[13.478239,52.443038],[13.478269,52.443012],[13.47838,52.442894],[13.478403,52.442868],[13.478462,52.442828],[13.478498,52.442804],[13.478547,52.442804],[13.478686,52.442737],[13.478748,52.44271],[13.47907,52.442568],[13.479138,52.44253],[13.484203,52.440055],[13.484275,52.440023],[13.48433,52.440006],[13.484396,52.43999],[13.484508,52.439965],[13.484636,52.439935],[13.484739,52.439904],[13.48481,52.439878],[13.485263,52.439652],[13.485877,52.439354],[13.487143,52.43874],[13.488976,52.437851],[13.489091,52.437791],[13.489148,52.437759],[13.489201,52.437716],[13.489317,52.437595],[13.489383,52.437543],[13.491752,52.436385],[13.494441,52.43508],[13.494516,52.435049],[13.494582,52.435028],[13.494922,52.43495],[13.495076,52.434886],[13.497087,52.43391],[13.497186,52.43385],[13.497533,52.433572],[13.497597,52.433548],[13.497804,52.433449],[13.497768,52.433426],[13.497833,52.433398],[13.497974,52.433336],[13.498066,52.433312],[13.49822,52.433284],[13.498358,52.433259],[13.498475,52.43323],[13.498536,52.433205],[13.499266,52.43285],[13.499992,52.432497],[13.500753,52.432127],[13.502558,52.43125],[13.504387,52.430362],[13.50597,52.429595],[13.506422,52.429386],[13.506912,52.429172],[13.507146,52.429072],[13.507393,52.428974],[13.507917,52.428774],[13.508689,52.428496],[13.509098,52.428361],[13.509329,52.428288],[13.509559,52.428216],[13.509996,52.428087],[13.510323,52.427996],[13.510565,52.42793],[13.51083,52.427856],[13.511397,52.427712],[13.511801,52.427625],[13.512115,52.42756],[13.512698,52.427443],[13.51342,52.427314],[13.514092,52.427209],[13.514866,52.427101],[13.515241,52.427059],[13.515575,52.427022],[13.515889,52.426988],[13.516219,52.426959],[13.516531,52.426936],[13.516858,52.426913],[13.517379,52.426881],[13.519365,52.426769],[13.519767,52.426753],[13.519899,52.426736],[13.519949,52.426726],[13.519996,52.426716],[13.520121,52.426673],[13.52028,52.426619],[13.520434,52.426591],[13.520456,52.426566],[13.520507,52.426558],[13.520503,52.426541],[13.520461,52.426243],[13.520427,52.42609],[13.52041,52.426048],[13.520368,52.425973],[13.520215,52.425696],[13.519562,52.424713],[13.519576,52.424711],[13.519606,52.42463],[13.519148,52.423952],[13.518787,52.423426],[13.518436,52.42291],[13.518548,52.422569],[13.518648,52.422264],[13.518651,52.422254],[13.518801,52.422131],[13.518909,52.422019],[13.519483,52.421423],[13.519913,52.421346],[13.520181,52.421027],[13.520504,52.420835],[13.520648,52.420189],[13.520845,52.419543],[13.521591,52.418897],[13.522121,52.418433],[13.522156,52.418298],[13.522131,52.417872],[13.52213,52.417355],[13.522142,52.417227],[13.522221,52.416923],[13.522499,52.416254],[13.522806,52.415701],[13.522959,52.41545],[13.522261,52.414429],[13.522587,52.414322],[13.522627,52.414153],[13.523804,52.413693],[13.524063,52.413591],[13.523597,52.413173],[13.523227,52.412653],[13.523446,52.412421],[13.523014,52.412134],[13.523307,52.411842],[13.52348,52.411669],[13.522934,52.41104],[13.523207,52.410812],[13.523013,52.410309],[13.522741,52.409604],[13.522613,52.409274],[13.522339,52.408544],[13.522242,52.408324],[13.521788,52.407444],[13.521666,52.407294],[13.521307,52.406976],[13.521015,52.406717],[13.520595,52.406407],[13.520706,52.406295],[13.520623,52.406237],[13.519053,52.405126],[13.519331,52.404942],[13.51877,52.404666],[13.518363,52.404393],[13.517547,52.403865],[13.517041,52.403567],[13.516652,52.403336],[13.516979,52.402838],[13.515985,52.402185],[13.516001,52.401835],[13.516003,52.401787],[13.515612,52.401686],[13.514639,52.401436],[13.514106,52.401283],[13.513882,52.401224],[13.513727,52.401189],[13.513544,52.401151],[13.513025,52.401046],[13.511746,52.400816],[13.510099,52.400568],[13.509122,52.400406],[13.508168,52.400264],[13.505745,52.399905],[13.503945,52.399694],[13.500984,52.39936],[13.500709,52.399328],[13.499167,52.399076],[13.497543,52.39881],[13.497438,52.3988],[13.496142,52.398676],[13.49503,52.398569],[13.494312,52.398444],[13.492911,52.398216],[13.492073,52.398063],[13.491125,52.397872],[13.490559,52.397757],[13.490056,52.397715],[13.487886,52.397534],[13.486743,52.39745],[13.486478,52.397415],[13.485639,52.397266],[13.484394,52.39707],[13.483549,52.396937],[13.481285,52.396361],[13.479762,52.395945],[13.479353,52.397781],[13.479171,52.398579],[13.479054,52.399198],[13.478982,52.399846],[13.478952,52.39998],[13.478776,52.400416],[13.478619,52.400744],[13.478297,52.401265],[13.478126,52.40159],[13.477716,52.402513],[13.477654,52.402653],[13.477607,52.402718],[13.477605,52.403055],[13.477635,52.403236],[13.47764,52.403324],[13.47761,52.403428],[13.477561,52.403494],[13.477525,52.403529],[13.47751,52.403543],[13.477492,52.403554],[13.477471,52.403567],[13.477323,52.403709],[13.477227,52.4038],[13.477034,52.403991],[13.476941,52.404106],[13.476846,52.404258],[13.47682,52.404308],[13.476779,52.404441],[13.476702,52.40459],[13.476641,52.404675],[13.476435,52.405019],[13.476301,52.405268],[13.475983,52.405944],[13.475902,52.40609],[13.47582,52.406239],[13.475636,52.40651],[13.475437,52.406799],[13.474168,52.408649],[13.474114,52.408789],[13.474004,52.408993],[13.473917,52.409157],[13.473546,52.409861],[13.473249,52.410423],[13.473174,52.410566],[13.473124,52.41066],[13.473007,52.41085],[13.472919,52.410992],[13.472694,52.411357],[13.472331,52.411912],[13.472127,52.412225],[13.471904,52.412567],[13.47151,52.413225],[13.471127,52.413867],[13.47101,52.414061],[13.470786,52.414508],[13.470527,52.415023],[13.470457,52.415151],[13.470194,52.415628],[13.469676,52.416563],[13.469468,52.416947],[13.46926,52.417347],[13.469193,52.417478],[13.46886,52.418121],[13.468797,52.418248],[13.468459,52.419038],[13.468389,52.419205],[13.468264,52.419501],[13.468049,52.419961],[13.468018,52.420032],[13.467148,52.420231],[13.466318,52.420427],[13.465346,52.420655],[13.464456,52.420865],[13.463547,52.42108],[13.463356,52.421055],[13.462073,52.420891],[13.461466,52.420821],[13.460894,52.420749],[13.46031,52.420676],[13.45946,52.420569],[13.458949,52.420483],[13.458184,52.42031],[13.457991,52.420263],[13.457691,52.420197],[13.457223,52.420093],[13.45654,52.419926],[13.456328,52.419865],[13.454687,52.419454],[13.4532,52.418947],[13.451933,52.418476],[13.451369,52.418295],[13.450775,52.418103],[13.450046,52.417871],[13.449566,52.417717],[13.448591,52.417394],[13.448157,52.41725],[13.447903,52.417158],[13.447833,52.417119],[13.447511,52.416938],[13.447248,52.416791],[13.447059,52.416685],[13.446001,52.416381],[13.4438,52.415753],[13.443235,52.415592],[13.443077,52.415534],[13.44288,52.415473],[13.44197,52.415195],[13.441566,52.415072],[13.440761,52.41486],[13.440612,52.414821],[13.440264,52.414744],[13.439988,52.414683],[13.438885,52.414446],[13.438674,52.414424],[13.438403,52.414353],[13.436105,52.413752],[13.435358,52.413565],[13.434216,52.413205],[13.431932,52.412514],[13.430352,52.412253],[13.430332,52.412284],[13.427953,52.411892],[13.427771,52.411856],[13.425564,52.411424],[13.424695,52.411254],[13.423119,52.410841],[13.421778,52.410532],[13.421468,52.410478],[13.42081,52.410364],[13.419583,52.410183],[13.419676,52.41049],[13.418395,52.410741],[13.418313,52.410757],[13.418161,52.410798],[13.418118,52.410814],[13.4181,52.410821],[13.41794,52.410882],[13.417149,52.411184],[13.41614,52.411576],[13.4152,52.411946],[13.414892,52.412067],[13.414267,52.412313],[13.413803,52.412442],[13.413107,52.412636],[13.412898,52.412699],[13.411486,52.413138],[13.410871,52.413265],[13.41068,52.413302],[13.410583,52.41332],[13.409968,52.413388],[13.409562,52.413404],[13.408469,52.413439],[13.40756,52.413401],[13.407328,52.413377],[13.407121,52.413356],[13.406127,52.413248],[13.406073,52.413243],[13.405178,52.413111],[13.405049,52.413092],[13.404713,52.413042],[13.402504,52.41271],[13.402302,52.413067],[13.402177,52.413288],[13.401538,52.414413],[13.401336,52.414768],[13.400762,52.415783],[13.400315,52.416572],[13.4001,52.416952],[13.400009,52.417114],[13.399497,52.418019],[13.400121,52.418773],[13.404239,52.419852],[13.404815,52.420002],[13.405468,52.421763],[13.402601,52.42216],[13.40276,52.422373],[13.402806,52.422434],[13.403034,52.422731],[13.403054,52.422758],[13.403091,52.422805],[13.40311,52.422829],[13.403275,52.423043],[13.40337,52.423166],[13.403477,52.423305],[13.403612,52.423469],[13.403889,52.423872],[13.404145,52.42422],[13.404752,52.424997],[13.405138,52.425502],[13.405268,52.425684],[13.405409,52.42589],[13.405579,52.426155],[13.405763,52.42646],[13.406095,52.427114],[13.406173,52.42734],[13.406238,52.427527],[13.406336,52.427808],[13.406542,52.42864],[13.40656,52.428742],[13.406571,52.428805],[13.406768,52.429891],[13.406866,52.430139],[13.406986,52.430317],[13.407017,52.430361],[13.407675,52.431334],[13.408245,52.432225],[13.408347,52.43236],[13.408605,52.432729],[13.408867,52.433182],[13.40898,52.433522],[13.409021,52.433773],[13.409069,52.433927],[13.409101,52.43403],[13.409113,52.434061],[13.409157,52.43421],[13.409695,52.435003],[13.409825,52.435216],[13.410151,52.435749],[13.410379,52.436144],[13.410441,52.437009],[13.410571,52.43746],[13.410774,52.437961],[13.410975,52.438432],[13.411175,52.438887],[13.411218,52.439022],[13.411258,52.439124]]]]}}]}
    m = folium.Map(location=[52.507, 13.43],tiles="Stamen Toner", zoom_start=13)
    folium.GeoJson(FK, name="FK", style_function= lambda x : style1).add_to(m)
    #folium.GeoJson("https://github.com/rbb-data/berlin-lor/blob/master/berlin-lor.planungsraeume.geojson", name="LOR").add_to(m)
    #LOR = folium.GeoJson(open('C:/Planungsraum.geojson').read())
    #folium.GeoJson(json.load(open('C:/Planungsraum.geojson'))).add_to(m)
    #folium.GeoJson(LOR, name="LOR", style_function= lambda x : style1).add_to(m)
    
    plugins.Fullscreen(position='topright', title='Click to expand', title_cancel='Click to exit', force_separate_button=True ).add_to(m)
    features = generate_timestamped_geojson(d)
    plugins.TimestampedGeoJson(
    {'type': 'FeatureCollection',
        'features': features}
        , period='P1D'
        , duration="P1D"
        , add_last_point=True
        , auto_play=False
        , loop=False
        , max_speed=1
        , loop_button=True
        , date_options='YYYY-MM-DD'
        , time_slider_drag_update=True).add_to(m)
    
    display(m)
    m.save("C:\\Users\\fku03532\\Desktop\\SORMAS API\\varianten-2021-10-15.html")
    